{
    "contents" : "source(\"scripts/functions.R\")\noptions(stringsAsFactors = FALSE)\n\n# load in data\n\nalltraits <- read.csv(\"data/alltraits.csv\", header=TRUE)\npercentcover <- read.csv(\"data/percentcover.csv\", header=TRUE)\n\n# subset out individual traits and remove null observations\n\nmaxheight <-   na.omit(\n               cbind(\"species\" = alltraits[1], \n                     \"maxheight\" = alltraits[2]))\n\nseedmass <- na.omit(\n              cbind(\"species\" = alltraits[1], \n                    \"seedmass\" = alltraits[3]))\n\nSLA <- na.omit(\n         cbind(\"species\" = alltraits[1], \n               \"SLA\" = alltraits[4]))\n\nWD <- na.omit(\n        cbind(\"species\" = alltraits[1], \n              \"WD\" = alltraits[5]))\n\n# remove observations that average less than 1% cover\n\npercentcover <- subset(percentcover, avgcover > 1)\n\n# subset by stratum\n\nground <- percentcover [percentcover$stratum == \"groundcover\",]\nshrub <- percentcover [percentcover$stratum == \"shrub\",]\nsubcanopy <- percentcover [percentcover$stratum == \"subcanopy\",]\ncanopy <- percentcover [percentcover$stratum == \"canopy\",]\n\n# find trait values at each layer\n\nmaxheight.ground <- traitsbylayer(maxheight, ground)\nmaxheight.shrub <- traitsbylayer(maxheight, shrub)\nmaxheight.subcanopy <- traitsbylayer(maxheight, subcanopy)\nmaxheight.canopy <- traitsbylayer(maxheight, canopy)\n\nseedmass.ground <- traitsbylayer(seedmass, ground)\nseedmass.shrub <- traitsbylayer(seedmass, shrub)\nseedmass.subcanopy <- traitsbylayer(seedmass, subcanopy)\nseedmass.canopy <- traitsbylayer(seedmass, canopy)\n\nSLA.ground <- traitsbylayer(SLA, ground)\nSLA.shrub <- traitsbylayer(SLA, shrub)\nSLA.subcanopy <- traitsbylayer(SLA, subcanopy)\nSLA.canopy <- traitsbylayer(SLA, canopy)\n\nWD.ground <- traitsbylayer(WD, ground)\nWD.shrub <- traitsbylayer(WD, shrub)\nWD.subcanopy <- traitsbylayer(WD, subcanopy)\nWD.canopy <- traitsbylayer(WD, canopy)\n\ntotalabundances =  as.data.frame(cbind(\"maxheight.ground\" = c(tapply(maxheight.ground$avgcover, maxheight.ground$plotID, sum)),\n                                       \"maxheight.shrub\" = c(tapply(maxheight.shrub$avgcover, maxheight.shrub$plotID, sum)),\n                                       \"maxheight.subcanopy\" = c(tapply(maxheight.subcanopy$avgcover, maxheight.subcanopy$plotID, sum)),\n                                       \"maxheight.canopy\" = c(tapply(maxheight.canopy$avgcover, maxheight.canopy$plotID, sum)),\n                                       \"seedmass.ground\" = c(tapply(seedmass.ground$avgcover, seedmass.ground$plotID, sum)),\n                                       \"seedmass.shrub\" = c(tapply(seedmass.shrub$avgcover, seedmass.shrub$plotID, sum)),\n                                       \"seedmass.subcanopy\" = c(tapply(seedmass.subcanopy$avgcover, seedmass.subcanopy$plotID, sum)),\n                                       \"seedmass.canopy\" = c(tapply(seedmass.canopy$avgcover, seedmass.canopy$plotID, sum)),\n                                       \"SLA.ground\" = c(tapply(SLA.ground$avgcover, SLA.ground$plotID, sum)),\n                                       \"SLA.shrub\" = c(tapply(SLA.shrub$avgcover, SLA.shrub$plotID, sum)),\n                                       \"SLA.subcanopy\" = c(tapply(SLA.subcanopy$avgcover, SLA.subcanopy$plotID, sum)),\n                                       \"SLA.canopy\" = c(tapply(SLA.canopy$avgcover, SLA.canopy$plotID, sum)),\n                                       \"WD.ground\" = c(tapply(WD.ground$avgcover, WD.ground$plotID, sum)),\n                                       \"WD.shrub\" = c(tapply(WD.shrub$avgcover, WD.shrub$plotID, sum)),\n                                       \"WD.subcanopy\" = c(tapply(WD.subcanopy$avgcover, WD.subcanopy$plotID, sum)),\n                                       \"WD.canopy\" = c(tapply(WD.canopy$avgcover, WD.canopy$plotID, sum))))\n\n# get total abundances over all layers (sum by row for specified columns)\n\ntotalabundances$maxheight <- rowSums(totalabundances[, c(2, 3, 4, 5)])\ntotalabundances$seedmass <- rowSums(totalabundances[, c(6, 7, 8, 9)])\ntotalabundances$SLA <- rowSums(totalabundances[, c(10, 11, 12, 13)])\ntotalabundances$WD <- rowSums(totalabundances[, c(6, 7, 8, 9)])\n\n                             \n                                      \n\n\n\n\ntraitslayers <- as.data.frame(cbind(\"traits\" = c(\"maxheight\",\"seedmass\",\"SLA\",\"WD\"),\n                                    \"layers\" = c(\"ground\", \"shrub\", \"subcanopy\", \"canopy\")))\n\nfor (i in 1:4(stuff) {\n\n  a <- traitsbylayer(traitslayers$traits[i], traitslayers$layers[i])\n\n  write.table(traitsbylayer.df, file=\"output/fitmodels.csv\", append=TRUE, sep=\",\", col.names=FALSE, row.names=FALSE)\n\n  \n  \n  \n  \n  plotsavgs <- cbind(\"plotID\" = unique(canopy$plotID),\n                     \"avg\" = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15))",
    "created" : 1395107511449.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2617516509",
    "id" : "5C6C299D",
    "lastKnownWriteTime" : 1395124161,
    "path" : "C:/Users/JLawson/Desktop/stuff/data/analysis/R/TGAall2/scripts/analysis.R",
    "project_path" : "scripts/analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}